var Ndoc=Ndoc||{};$(function(){var t=Nehan.Env.client;t.isIE()&&t.version<=8&&$(".legacy-browser-alert").show(),$(".nehan-reader").each(function(t,e){var i=$(e),n=i.html(),s=i.data("flow");new Ndoc.Reader({el:e,data:{text:n,flow:s}})})}),Ndoc.Settings={},Nehan.setStyles({body:{textAlign:"justify",width:"90%",height:function(){return Math.floor(55*screen.height/100)}}}),Ndoc.Reader=Vue.extend({template:"#tmpl-reader",data:function(){return{flow:"lr-tb",text:"text is not defined.",pageIndex:0,pageCount:0,width:400,height:300,fontSize:12}},computed:{pageNo:function(){return this.pageIndex+1},leftButtonPopup:function(){return this.isVert()?"forward page":"backward page"},rightButtonPopup:function(){return this.isVert()?"backward page":"forward page"},leftButtonLabel:function(){return this.isVert()?"<i class='flipped play icon'></i>":"<i class='backward icon'></i>"},rightButtonLabel:function(){return this.isVert()?"<i class='flipped backward icon'></i>":"<i class='play icon'></i>"},leftButtonColor:function(){return this.isVert()?"blue":"red"},rightButtonColor:function(){return this.isVert()?"red":"blue"}},ready:function(){this.mountReader(),this.$watch("flow",this.mountReader),$(this.$el).find(".popup-enabled").popup()},methods:{mountReader:function(){this.pageIndex=0,this.pageCount=0,this.element=document.createElement("div"),this.pages=(new Nehan.Document).setStyle("body",{flow:this.flow,width:this.width,height:this.height,"font-size":this.fontSize,"word-break":"tb-rl"===this.flow?"break-all":"normal"}).setContent(this.text).render({onProgress:function(){this.pageCount++}.bind(this),onComplete:function(){}}),this.element.appendChild(this.pages.getPage(0).element),$(this.$$.screen).empty().css({width:this.width+20,height:this.height+25}).append(this.element)},isVert:function(){return"tb-rl"===this.flow},setPage:function(t){var e=this.pages.getPage(t);this.element.innerHTML="",this.element.appendChild(e.element)},setNextPage:function(){this.pageIndex=Math.min(this.pageIndex+1,this.pageCount-1),this.setPage(this.pageIndex)},setPrevPage:function(){this.pageIndex=Math.max(0,this.pageIndex-1),this.setPage(this.pageIndex)},onClickHori:function(){this.flow="lr-tb"},onClickVert:function(){this.flow="tb-rl"},onClickLeft:function(){this.isVert()?this.setNextPage():this.setPrevPage()},onClickRight:function(){this.isVert()?this.setPrevPage():this.setNextPage()}}});