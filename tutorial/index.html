<!DOCTYPE HTML>
<html lang="en">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="description" content="nehan.js document">
    <meta name="keywords" content="nehan.js,nehan,javascript">
    <title>nehan.js doc - Tutorial</title>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.css">
<link rel="stylesheet" href="../static/semantic/semantic.min.css">
<link rel="stylesheet" href="../static/css/main.css">
<link rel="stylesheet" href="../static/css/nehan.css">

    <meta name="generator" content="nanoc 3.8.0">
  </head>
  <body>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-399060-28', 'auto');
  ga('send', 'pageview');

</script>

    <header class="global-header">
  <div class="inner">
    <a class="logo" href="../index.html">nehan.js</a>
    <nav class="global-nav">
      <ul>
	<li><a class="current" href="../tutorial">Tutorial</a></li>
	<li><a href="http://tb.antiscroll.com/static/nehan-demo/">Demo</a></li>
	<!--
	<li><a href="http://tb.antiscroll.com/static/editor/">Playground</a></li>
	-->
	<li><a href="http://tb.antiscroll.com/static/nehan-api/">API</a></li>
      </ul>
    </nav>
  </div>
</header>

<div class="ui error icon legacy-browser-alert message" style="display:none">
  <i class="warning sign icon"></i>
  <div class="content">
    <div class="header">未対応のブラウザ</div>
    <p>当サイトはお使いのブラウザに対応していません。より新しいブラウザでアクセスして下さい。</p>
  </div>
</div>

    <main class="global-main">
      <div class="inner">
	<h1>Tutorial</h1>

<h2>Install</h2>

<p>Just include nehan.js, nehan.css in the <code>head</code>.</p>

<div class="code-container"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-markup">&lt;link rel="stylesheet" href="/path/to/nehan.css"&gt;
&lt;script type="text/javascript" src="/path/to/nehan.js"&gt;&lt;/script&gt;</code></pre></div></div></div>

<h2>Getting Started</h2>

<div class="code-container"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-javascript"><span class="keyword">var</span> doc = <span class="keyword">new</span> Nehan.Document();

<span class="comment">// setStyle(selector, value)</span>
doc.setStyle(<span class="string"><span class="delimiter">"</span><span class="content">body</span><span class="delimiter">"</span></span>, {
  <span class="key">flow</span>:<span class="string"><span class="delimiter">"</span><span class="content">lr-tb</span><span class="delimiter">"</span></span>, <span class="comment">// or "tb-rl"</span>
  <span class="key">fontSize</span>:<span class="integer">16</span>, <span class="comment">// camel-case is supported(version &gt;= 5.1.1)</span>
  <span class="key">width</span>:<span class="integer">640</span>, <span class="comment">// page width</span>
  <span class="key">height</span>:<span class="integer">480</span> <span class="comment">// page height</span>
});
  
doc.setContent(<span class="string"><span class="delimiter">"</span><span class="content">&lt;p&gt;hello, nehan.js!!&lt;/p&gt;</span><span class="delimiter">"</span></span>);

doc.render({
  <span class="function">onPage</span>: <span class="keyword">function</span>(page, ctx){
    console.log(<span class="string"><span class="delimiter">"</span><span class="content">page object:%o, pageNo:%d, dom element:%o</span><span class="delimiter">"</span></span>, page, page.pageNo, page.element);
  },
  <span class="function">onComplete</span>: <span class="keyword">function</span>(time, ctx){
    <span class="comment">// parsing complete, now you can get outline(toc) element.</span>
    <span class="keyword">var</span> outline = ctx.createOutlineElement({
      <span class="function">onClickLink</span>:<span class="keyword">function</span>(toc){
        <span class="comment">// console.log("click %o", toc);</span>
      }
    })
    console.log(<span class="string"><span class="delimiter">"</span><span class="content">finished! %fmsec</span><span class="delimiter">"</span></span>, time);
  }
});</code></pre></div></div></div>

<div class="ui hidden divider"></div>

<p>After <code>Nehan.Document::render</code> is called, you can use some document method like this.</p>

<div class="ui hidden divider"></div>

<div class="code-container"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-javascript"><span class="comment">// you can get page directly by page index.</span>
<span class="keyword">var</span> first_page = doc.getPage(<span class="integer">0</span>);
<span class="keyword">var</span> second_page = doc.getPage(<span class="integer">1</span>);

<span class="comment">// total page count is obtained by 'getPageCount',</span>
<span class="comment">// but it's incorrect if 'onComplete' is not called.</span>
<span class="keyword">var</span> total_page_count = doc.getPageCount();</code></pre></div></div></div>

<h2>About Styling</h2>

<p>As you see above example, stying in nehan.js is done by <code>setStyle</code>.</p>

<p>First argument is <code>selector-key</code> and second is <code>selector-value</code>.</p>

<p>But selector value of nehan.js is something different from standard css.</p>

<p>Because nehan.js is <strong>logical</strong> layout engine, you must use <strong>logical</strong> property.</p>

<h3>logical size</h3>

<p>For example, generally you might set width of some element like <code>width:300px</code>, but in nehan.js, the meaning of <code>width</code> is different as to <code>flow</code> of document.</p>

<p>If <code>flow</code> of document is <code>lr-tb</code>, <code>width</code> means the size along inline level direction, but if <code>flow</code> is <code>tb-rl</code>, <code>width</code> means the size along block level direction, because in vertical mode, block level flows from left to right(or right to left).</p>

<p>So if you want to set the size of inline direction, you must use the property <code>measure</code>, and use the property <code>extent</code> for the block level direction.</p>

<div class="ui icon info message">
<i class="info icon"></i><p class="content">For more details for logical property, see <a href="http://www.w3.org/TR/2012/WD-css3-writing-modes-20121115/#abstract-box">CSS Writing Modes Module Level3 - Abstract box dimemsions.</a>.</p>
</div>

<h3>logical direction</h3>

<p>For example, lets define some simple style like bellow.</p>

<div class="code-container"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-javascript"><span class="comment">// all class name of nehan is required "nehan-" prefix.</span>
doc.setStyle(<span class="string"><span class="delimiter">"</span><span class="content">.example1</span><span class="delimiter">"</span></span>, {
  <span class="key">margin</span>:{<span class="key">after</span>:<span class="string"><span class="delimiter">"</span><span class="content">20px</span><span class="delimiter">"</span></span>}
});</code></pre></div></div></div>

<p>You might wonder what is <code>after</code>?</p>

<p>This is <em>logical direction</em>.</p>

<p>Logical direction consists of <code>start</code>, <code>end</code>, <code>before</code>, <code>after</code>.</p>

<ul>
<li>
<code>start</code> means start direction along inline direction.</li>
<li>
<code>end</code> means end direction along inline direction.</li>
<li>
<code>before</code> means before direction along block direction.</li>
<li>
<code>after</code> means after direction along block direction.</li>
</ul>

<p>For example, if flow is <code>lr-tb</code>(left to right inline, top to bottom block), <code>margin:{after:"20px"}</code> means <code>margin-bottom:"20px"</code>.</p>

<p>But if flow is <code>tb-rl</code>(Japanese vertical), it means <code>margin-left:20px</code>!!</p>

<p>Because in <code>tb-rl</code>, block level flows from <strong>right to left</strong>.</p>

<h3>functional css property</h3>

<p>Set <code>backgrond-color</code> to <code>blue</code> if nth-child is even, otherwise <code>red</code>.</p>

<div class="code-container"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-javascript">doc.setStyle(<span class="string"><span class="delimiter">"</span><span class="content">.example2</span><span class="delimiter">"</span></span>, {
  <span class="key"><span class="delimiter">"</span><span class="content">background-color</span><span class="delimiter">"</span></span>:<span class="keyword">function</span>(ctx){
     <span class="keyword">if</span>(ctx.getChildIndex() % <span class="integer">2</span> === <span class="integer">0</span>){
       <span class="keyword">return</span> <span class="string"><span class="delimiter">"</span><span class="content">blue</span><span class="delimiter">"</span></span>;
     } <span class="keyword">else</span> {
       <span class="keyword">return</span> <span class="string"><span class="delimiter">"</span><span class="content">red</span><span class="delimiter">"</span></span>;
     }
  }
});</code></pre></div></div></div>

<p>Because functional value is supported in nehan.js, you don't have to use css property like <code>nth-child</code>, instead, you can use context object and javascript logic, it's more natual and powerfull isn't it?</p>

<p>Note that type of argument <code>ctx</code> is <a href="http://tb.antiscroll.com/static/nehan-api/Nehan.SelectorContext.html">SelectorContext</a>.</p>

<h3>global style</h3>

<p>You can set global style by <code>Nehan.setStyle</code>.</p>

<div class="code-container"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-javascript"><span class="comment">// this is 'local' style for paged-element.</span>
doc.setStyle(<span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>, {
  <span class="key">margin</span>:{<span class="key">after</span>:<span class="string"><span class="delimiter">"</span><span class="content">1em</span><span class="delimiter">"</span></span>}
});

<span class="comment">// this is 'global' style.</span>
Nehan.setStyle(<span class="string"><span class="delimiter">"</span><span class="content">h1</span><span class="delimiter">"</span></span>, {
  <span class="key"><span class="delimiter">"</span><span class="content">font-size</span><span class="delimiter">"</span></span>:<span class="string"><span class="delimiter">"</span><span class="content">3em</span><span class="delimiter">"</span></span>
});

<span class="comment">// set all width of paged-media to 80% of screen.</span>
Nehan.setStyle(<span class="string"><span class="delimiter">"</span><span class="content">body</span><span class="delimiter">"</span></span>, {
  <span class="key"><span class="delimiter">"</span><span class="content">width</span><span class="delimiter">"</span></span>:<span class="keyword">function</span>(){
    <span class="keyword">return</span> Math.floor(screen.width * <span class="integer">80</span> / <span class="integer">100</span>);
  }
});</code></pre></div></div></div>

<h3>selector callback</h3>

<p>Using <code>onload</code> property, you can change markup dynamically before parsing.</p>

<div class="code-container"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-javascript">doc.setStyle(<span class="string"><span class="delimiter">"</span><span class="content">.time</span><span class="delimiter">"</span></span>, {
  <span class="function">onload</span>:<span class="keyword">function</span>(context){
     <span class="keyword">var</span> markup = context.getMarkup();
     <span class="keyword">var</span> now = <span class="keyword">new</span> Date().toDateString();

     <span class="comment">// dynamically rewrite markup content.</span>
     markup.setContent([
       <span class="string"><span class="delimiter">"</span><span class="content">&lt;p&gt;You have visited this page at &lt;time&gt;</span><span class="delimiter">"</span></span> + now + <span class="string"><span class="delimiter">"</span><span class="content">&lt;/time&gt;&lt;/p&gt;</span><span class="delimiter">"</span></span>,
       markup.getContent()
     ].join(<span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span>));
  }
});</code></pre></div></div></div>

<h3>DOM creation callback</h3>

<p>By using <code>oncreate</code> property, you can hook just after the target selector is converted into DOM.</p>

<div class="code-container"><div class="CodeRay"><div class="code"><pre class="highlight"><code class="language-javascript">doc.setStyle(<span class="string"><span class="delimiter">"</span><span class="content">p</span><span class="delimiter">"</span></span>, {
  <span class="function">oncreate</span>:<span class="keyword">function</span>(context){
    <span class="comment">// console.log("abstract logical tree:%o", context.box);</span>
    <span class="predefined">$</span>(context.dom).click(<span class="keyword">function</span>(){
       alert(<span class="string"><span class="delimiter">"</span><span class="content">click p!</span><span class="delimiter">"</span></span>);
    });
  }
});</code></pre></div></div></div>

<p>Note that type of argument <code>ctx</code> at <code>oncreate</code> is <a href="http://tb.antiscroll.com/static/nehan-api/Nehan.DomCreateContext.html">DomCreateContext</a>.</p>

      </div>
    </main>
    <script type="text/x-template" id="tmpl-reader">
  <div class="pager">
    <button class="ui {{leftButtonColor}} left icon button"
	    v-on="click:onClickLeft">&larr; {{{ leftButtonLabel }}}</button>
    <div class="progress"><span class="page-no" v-text="pageNo"></span> of <span class="page-count" v-text="pageCount"></span></div>
    <button class="ui {{rightButtonColor}} right icon button"
	    v-on="click:onClickRight">{{{ rightButtonLabel }}} &rarr;</button>
    <div class="ui icon buttons">
      <button v-class="green:!isVert()" class="ui popup-enabled button" v-on="click:onClickHori" data-content="horizontal"><i class="align left icon"></i> Horizontal</button>
      <div class="or"></div>
      <button v-class="green:isVert()" class="ui popup-enabled button" v-on="click:onClickVert" data-content="vertical"><i class="rotated align left icon"></i> Vertical</button>
    </div>
  </div>
  <div class="screen" v-el="screen"></div>
</script>

    <div class="global-footer">
</div>

    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.3/fastclick.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/vue/0.11.3/vue.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/prism/0.0.1/prism.min.js"></script>
<script type="text/javascript" src="../static/semantic/semantic.min.js"></script>
<script type="text/javascript" src="../static/js/nehan.min.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
  });
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/javascript" src="../static/js/nehan.math.js"></script>
<script type="text/javascript" src="../static/js/main.min.js"></script>

  </body>
</html>
