# nehan.js

## Introduction

nehan.js is dynamic layout engine written in javascript, enable to yield **paged media** in non blocking way.

Almost all html5 tags are supported, and further more, vertical layout(lr-tb, rl-tb) supported.

Available on IE8+, Firefox3.5+, Google Chrome4+, Safari3+, Opera10+ etc.

## Install

Include css, js in the ``<head>``

```
<link href="/path/to/nehan.css" type="text/css" rel="stylesheet">
<script src="/path/to/nehan.js" type="text/javascript"></script>
```

## Quick Start

```javascript
// create layout engine.
var engine = Nehan.setup();

// define engine local style.
engine.setStyles({
  // notice that 'body size' = 'page size'.
  "body":{
    "flow":"lr-tb", // document mode horizontal
    //"flow":"tb-rl", // document mode vertical(Japanese)
    "width":"80%", // percent size from parent, 'screen.width' at this case.
    // "width":900, // direct size
    "height":"60%", // percent size from parent, 'screen.height' at this case.
    "font-size":16, // notice that camel-case(fontSize) is not allowed.
    "font-family":"Meiryo",
    // functional property is supported.
    "background-color":function(prop_context){
      return "white";
    },
    // onload callback is called after all the properties of this selector('body' at this case) are loaded.
    "onload":function(selector_context){
      var markup = selector_context.getMarkup();
      console.log(markup.getName()); // => "body"
      console.log(markup.getAttr("foo")); // => 'aaa' if <body foo='aaa'>
      console.log(markup.getData("fuga")); // => '10' if <body data-fuga='10'>
      console.log(markup.getContent()); // => 'hello' if <body>hello</body>
      console.log(markup.getCssAttr("font-family")); // => 'Meiryo'

      // you can overwrite content dynamically like this.
      markup.setContent(markup.getContent() + "!!");

      // other context variables....
      console.log("nth-child is %d", selector_context.getChildIndex());
      console.log("nth-child-of-type is %d", selector_context.getChildIndexOfType());
      console.log("rest extent size is %d", selector_context.getRestExtent());
      console.log("rest measure size is %d", selector_context.getRestMeasure());
    },
    // oncreate callback is called when this element is actually generated by evaluator.
    "oncreate":function(dom, selector_context){
      alert("body element is created");
    }
  },
  // you can use regexp as element name like this.
  "header /h[1-6]/":{
    "font-weight":"bold",
    // notice that directions in nehan.js are defined as 'logical' like this.
    "margin":{
      "after":"1.5em" // 'after' is 'bottom' if body.flow = 'lr-tb'('left' if 'tb-rl').
    }
  }
});

// generate page stream from engine.
var page_stream = engine.createPageStream("<h1>hello, nehan.js</h1>");

// get target dom.
var dst_target = document.getElementById("my-page-document");

// start parsing
page_stream.asyncGet({
  // called when each abstract layout tree is generated.
  onProgress: function(stream, tree){
    var page = stream.getPage(tree.pageNo); // tree -> page
    dst_target.appendChild(page.element);
  },
  // called when all pages are generated.
  onComplete: function(stream, time){
    console.log("finished!! => %fmsec", time);
  }
});
```

## Demo & Document

Demo and document is [here](http://tategakibunko.github.io/nehan.js).

## jQuery plugin

jQuery plugin is [here](http://tategakibunko.github.io/jquery.nehan).

## License

MIT License
